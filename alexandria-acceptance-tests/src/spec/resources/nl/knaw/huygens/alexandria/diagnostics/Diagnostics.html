<html xmlns:c="http://www.concordion.org/2007/concordion"
      xmlns:h="http://huygens.knaw.nl/concordion-acceptance-test"
      xmlns:xsi="http://www.w3.org/1999/xhtml"
      xsi:schemaLocation="http://huygens.knaw.nl/concordion-acceptance-test
                          http://huygensing.github.io/alexandria/xsd/concordion-rest.xsd">

<title>Nederlab Scenarios</title>

<body data-desc="Nederlab Scenarios">

<!-- TODO: Move to 'cat' and generate -->
<div class="dropdown">
    <button class="btn btn-primary pull-right dropdown-toggle" type="button" data-toggle="dropdown">Test Sources
        <span class="caret"></span></button>
    <ul class="dropdown-menu dropdown-menu-right">
        <li>
            <a href="https://github.com/HuygensING/alexandria/blob/master/alexandria-acceptance-tests/src/spec/java/nl/knaw/huygens/alexandria/diagnostics/DiagnosticsFixture.java">Fixture</a>
        </li>
        <li>
            <a href="https://github.com/HuygensING/alexandria/blob/master/alexandria-acceptance-tests/src/spec/resources/nl/knaw/huygens/alexandria/diagnostics/Diagnostics.html">Specification</a>
        </li>
    </ul>
</div>

<div id="dia-404" data-desc="When can I expect a 404 Not Found?" c:execute="clearStorage()">
    <ul>
        <li>
            <h4>Accessing a non-existent endpoint</h4>

            <h:request>When we
                <h:get>/resource/fa1303c2-5072-11e5-af91-6b4599821240</h:get>
                we observe
                <h:status>404 Not Found</h:status>
                and an
                <h:responseBody/>
                response body.
            </h:request>

            <div class="alert alert-info sm">
                In this case the address of the resources endpoint was misspelled:
                <del>/resource/</del>
                instead of /resources/
            </div>

        </li>

        <li>
            <h4>Accessing a non-existent resource at the correct endpoint</h4>

            <h:request>When we
                <h:get>/resources/fa1303c2-5072-11e5-af91-6b4599821240</h:get>
                we observe
                <h:status>404 Not Found</h:status>
                and the body contains the following hint
                <h:jsonResponse>{
                    "error": {
                    "message": "No resource found with id fa1303c2-5072-11e5-af91-6b4599821240"
                    } }
                </h:jsonResponse>
            </h:request>
        </li>
    </ul>
</div>

<div id="use-before-confirm" data-desc="When can I expect a 409 Conflict?" c:execute="clearStorage()">
    This is has to do with following the
    <mark>try-confirm-cancel</mark>
    pattern which the
    <a href="../transactions/Transactions.html">Transactions</a> section explains in detail.

    <hr/>

    <div class="alert alert-warning sm">
        <strong data-toggle="tooltip" title="Too long; didn't read">tl;dr</strong>
        If you have just created a (sub)resource or annotation via <code>POST</code>
        (not <code>PUT</code>) remember to:
        <ul>
            <li>check the Location header on the <code>201 Created</code> server response</li>
            <li><code>POST</code> the body <code>{"state":"CONFIRMED"}</code> to this location</li>
        </ul>
    </div>
</div>

</body>
</html>
